<div class="dialog-header">
  <h2 mat-dialog-title>{{ isEditMode ? 'Edit Card' : 'Create New Card' }}</h2>
  <button mat-icon-button (click)="close()" class="close-btn">
    <mat-icon>close</mat-icon>
  </button>
</div>

<mat-dialog-content class="dialog-content">
  <form class="card-form">
    <!-- Image Upload Section -->
    <div class="image-upload-section">
      <div class="image-preview" *ngIf="imagePreview">
        <img [src]="imagePreview" alt="Preview" />
        <button type="button" mat-icon-button class="remove-image-btn" (click)="removeImage()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <div class="upload-placeholder" *ngIf="!imagePreview">
        <mat-icon>add_photo_alternate</mat-icon>
        <p>Upload Photo</p>
      </div>
      <input 
        type="file" 
        #fileInput 
        (change)="onFileSelected($event)" 
        accept="image/*"
        style="display: none;"
      />
      <button 
        type="button" 
        mat-raised-button 
        color="primary" 
        (click)="fileInput.click()"
        class="upload-btn">
        <mat-icon>upload</mat-icon>
        Choose Image
      </button>
    </div>

    <!-- Form Fields -->
    <div class="form-grid">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Full Name</mat-label>
        <input matInput [(ngModel)]="card.name" name="name" required />
        <mat-icon matPrefix>person</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Gender</mat-label>
        <mat-select [(ngModel)]="card.gender" name="gender" required>
          <mat-option *ngFor="let option of genderOptions" [value]="option.value">
            {{ option.label }}
          </mat-option>
        </mat-select>
        <mat-icon matPrefix>wc</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Birth Date</mat-label>
        <input matInput [matDatepicker]="picker" [(ngModel)]="card.birthDate" name="birthDate" />
        <mat-icon matPrefix>cake</mat-icon>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput type="email" [(ngModel)]="card.email" name="email" required />
        <mat-icon matPrefix>email</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Phone</mat-label>
        <input matInput type="tel" [(ngModel)]="card.phone" name="phone" required />
        <mat-icon matPrefix>phone</mat-icon>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Address</mat-label>
        <textarea matInput [(ngModel)]="card.address" name="address" rows="3"></textarea>
        <mat-icon matPrefix>location_on</mat-icon>
      </mat-form-field>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-button (click)="close()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!isValid()">
    <mat-icon>{{ isEditMode ? 'save' : 'add' }}</mat-icon>
    {{ isEditMode ? 'Save Changes' : 'Create Card' }}
  </button>
</mat-dialog-actions>
